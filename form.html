<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  </head>
  <body>
    <style>
      /* include */
      @import url(https://fonts.googleapis.com/earlyaccess/cwtexming.css);
      
      *{
        font-family: 'cwTeXMing', serif;
        line-height: 3rem;
        font-weight:300;
        font-size: large;
        box-sizing: border-box;
      }

      body{
        background-color: #FDF6C4;
      }

      .all{
        margin-top: 2rem;
      }

      #p1, #p2, #p3{
        border: solid 3px #FFD000;
        border-radius: 2rem;
      }
    </style>

    <!-- form -->
    <div class="container-fluid all">
      <form class="row g-3" id="theform">

        <div class="mb-3 row">
          <label for="name" class="form-label">姓名</label>
          <input type="text" class="form-control" id="name" required="required">
        </div>

        <!-- problem 1 -->
        <div class="mb-3 row">
          <label for="p1" class="form-label">P1:</label>
          <div id="p1">
            <div>
              <input type="radio" id="o1-1" name="a1" value="1" checked />
              <label for="o1-1" class="form-label">...</label>
            </div>
            <div>
              <input type="radio" id="o1-2" name="a1" value="2"/>
              <label for="o1-2" class="form-label">...</label>
            </div>
            <div>
              <input type="radio" id="o1-3" name="a1" value="3"/>
              <label for="o1-3" class="form-label">...</label>
            </div>
          </div>
        </div>

        <!-- problem 2 -->
        <div class="mb-3 row">
          <label for="p2" class="form-label">P2:</label>
          <div id="p2">
            <div>
              <input type="radio" id="o2-1" name="a2" value="1" checked />
              <label for="o2-1" class="form-label">...</label>
            </div>
            <div>
              <input type="radio" id="o2-2" name="a2" value="2"/>
              <label for="o2-2" class="form-label">...</label>
            </div>
            <div>
              <input type="radio" id="o2-3" name="a2" value="3"/>
              <label for="o2-3" class="form-label">...</label>
            </div>
          </div>
        </div>

        <!-- problem 3 -->
        <div class="mb-3 row">
          <label for="p3" class="form-label">P3:</label>
          <div id="p3">
            <div>
              <input type="radio" id="o3-1" name="a3" value="1" checked />
              <label for="o3-1" class="form-label">...</label>
            </div>
            <div>
              <input type="radio" id="o3-2" name="a3" value="2"/>
              <label for="o3-2" class="form-label">...</label>
            </div>
            <div>
              <input type="radio" id="o3-3" name="a3" value="3"/>
              <label for="o3-3" class="form-label">...</label>
            </div>
          </div>
        </div>

        <!-- mbti -->
        <div class="mb-3 row">
          <label for="mbti" class="form-label">小調查：你的MBTI是？（不想透露可以不填）</label>
          <input type="text" class="form-control" id="mbti">
        </div>

        <button type="submit" class="btn btn-outline-success mb-3" id="submit" style="text-align: center;">Submit</button>

      </form>
    </div>
    



    <!--JS-->
    <script>
        function validateForm() {
            let x = document.forms["theform"]["name"].value;
            if (x == "") {
                alert("請填寫姓名！");
                return false;
            }
            return true;
        }

        function afterButtonClicked() {
            if(validateForm()){
                let name = document.getElementById("name");
                let a1 = document.getElementById("a1");
                let a2 = document.getElementById("a2");
                let a3 = document.getElementById("a3");
                let mbti = document.getElementById("mbti");
                let rowData = {
                    name: name.value,
                    a1: $("[name='a1']:checked").val(),
                    a2: $("[name='a2']:checked").val(),
                    a3: $("[name='a3']:checked").val(),
                    mbti: mbti.value
                };

                google.script.run.addData(rowData);
                document.getElementById("theform").reset();
                alert("感謝作答！！\n請按確定查看此次測驗結果");
            }
        }

        document.getElementById("submit").addEventListener("click", afterButtonClicked);
    </script>

    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script>
        $(function(){
            let _h = $(document).height();
            parent.postMessage({ h: _h}, '*');
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
  </body>
</html>